{% extends 'layout.html' %}

{% block body%}
<div class="row">
    <div class="col-md-12">
        <table class="table table-striped table-bordered bg-black table-lg">
            <thead>
                <tr>
                  <td class="text-center">Capitulo</td>
                  <td class="text-center">TÃ­tulo</td>
                  <td class="text-center">Precio</td>
                  <td class="text-center">Estado</td> 
                  <td class="text-center">Acciones</td> 
                </tr>
            </thead>
            <tbody>
               {% for chapter in data %}
                <tr>
                    <td class="text-center">1x{{chapter}}</td>
                    <td class="text-center">{{db.hmget(chapter, 'titulo')[0]}}</td>
                    <td class="text-center">$ {{db.hmget(chapter, 'precio')[0]}}</td>
                    <td class="text-center">
                    {% if db.exists('estado ' + chapter) == 0 %}
                        disponible
                    {% else %}
                        {{db.get('estado ' + chapter)}}
                    {% endif %}
                    </td>
                    <td class="text-center"> 
                        {% if db.exists('estado ' + chapter) == 0 %}
                            <a href="/reservar?capitulo={{chapter}}" class="btn btn-success">Alquilar</a>
                        {% else %}
                            {% if db.get('estado ' + chapter) == 'reservado' %}
                                <a href="/confirmar-pago?capitulo={{chapter}}&precio={{db.hmget(chapter, 'precio')[0]}}" class="btn btn-primary">Confirmar Pago</a>
                            {% else %}
                                {% if db.get('estado ' + chapter) == 'alquilado' %} 
                                    <p class="text-danger">--</p>
                                {% endif %}
                            {% endif %}
                        {% endif %}  
                    </td>
                </tr>
               {% endfor %} 
            </tbody>
        </table>
    </div>
</div>


{% endblock %}